import { CreateWorkflowDto, StartWorkflowDto, ProcessTaskDto } from './dto/create-workflow.dto';
import { UpdateWorkflowDto } from './dto/update-workflow.dto';
import { JsonStorageService } from '../common/json-storage.service';
import type { WorkflowDefinition, WorkflowInstance, WorkflowTask, WorkflowStatistics, NodeType } from '../common/workflow-interfaces';
export declare class WorkflowsService {
    private readonly storageService;
    constructor(storageService: JsonStorageService);
    create(createDto: CreateWorkflowDto, userId: string): WorkflowDefinition;
    private getDefaultNodes;
    findAll(userId: string, isAdmin: boolean, page?: number, pageSize?: number, category?: string, status?: string): {
        data: WorkflowDefinition[];
        total: number;
        page: number;
        pageSize: number;
    };
    findOne(id: string): WorkflowDefinition;
    update(id: string, updateDto: UpdateWorkflowDto): WorkflowDefinition;
    remove(id: string): void;
    publish(id: string): WorkflowDefinition;
    private validateWorkflow;
    startWorkflow(workflowId: string, startDto: StartWorkflowDto, userId: string, userName: string): WorkflowInstance;
    private moveToNextNode;
    private handleNodeType;
    private evaluateCondition;
    private evaluateExpression;
    private createParallelTasks;
    private executeAction;
    private autoCreateTask;
    private sendNotification;
    private updateBusinessData;
    private callWebhook;
    private createTasks;
    private resolveApprovers;
    processTask(taskId: string, processDto: ProcessTaskDto, userId: string, userName: string): WorkflowTask;
    private processInstance;
    private createLog;
    getInstances(userId: string, isAdmin: boolean, page?: number, pageSize?: number, status?: string, businessType?: string): {
        data: WorkflowInstance[];
        total: number;
        page: number;
        pageSize: number;
    };
    getMyTasks(userId: string, page?: number, pageSize?: number, status?: string): {
        data: WorkflowTask[];
        total: number;
        page: number;
        pageSize: number;
    };
    getInstanceDetail(instanceId: string, userId?: string, isAdmin?: boolean): {
        instance: {
            workflowName: string;
            currentNodeName: string;
            id: string;
            workflowId: string;
            workflowVersion: number;
            businessType: string;
            businessId: string;
            businessData: Record<string, any>;
            variables: Record<string, any>;
            currentNodeId: string;
            status: import("../common/workflow-interfaces").InstanceStatus;
            result?: "approved" | "rejected" | "cancelled";
            initiator: string;
            initiatorName: string;
            startedAt: string;
            finishedAt?: string;
            duration?: number;
        };
        tasks: {
            nodeName: string;
            assigneeName: string;
            id: string;
            instanceId: string;
            workflowName: string;
            businessType: string;
            businessId: string;
            businessTitle: string;
            nodeId: string;
            nodeType: NodeType;
            assigneeId: string;
            status: "pending" | "approved" | "rejected" | "transferred";
            opinion?: string;
            attachments?: string[];
            processedAt?: string;
            createdAt: string;
            dueDate?: string;
            priority: "low" | "medium" | "high";
        }[];
        logs: {
            nodeName: string;
            id: string;
            instanceId: string;
            nodeId: string;
            action: "start" | "approve" | "reject" | "transfer" | "cancel" | "timeout" | "execute_action";
            operator: string;
            operatorName: string;
            opinion?: string;
            fromNodeId?: string;
            toNodeId?: string;
            duration?: number;
            createdAt: string;
        }[];
    };
    getStatistics(userId: string, isAdmin: boolean): WorkflowStatistics;
    private groupByStatus;
    private groupByBusinessType;
    generateMockData(count: number, userId: string, userName: string): number;
    private createDefaultOrderApprovalWorkflow;
    private createConditionalWorkflow;
    private createParallelWorkflow;
    clearMockData(userId: string, isAdmin: boolean): number;
}
